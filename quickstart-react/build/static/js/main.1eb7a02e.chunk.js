(this["webpackJsonpmonday-integration-quickstart-app"]=this["webpackJsonpmonday-integration-quickstart-app"]||[]).push([[0],{101:function(e,t,n){"use strict";n.r(t);var o=n(0),i=n.n(o),a=n(4),l=n.n(a),s=(n(65),n(24)),c=n(28),r=n(29),u=n(56),d=n(55),p=(n(66),n(40)),m=n.n(p),g=(n(82),n(7)),h=n(18),f=n(52),v=n.n(f),y=n(53),b=n.n(y),x=n(133),E=n(132),k=Object(o.memo)((function(e){var t=e.data,n=Object(o.useState)(!0),a=Object(h.a)(n,2),l=a[0],s=a[1],c=l?{bottom:"-2px"}:{top:"-2px"},r=l?{top:"-2px"}:{bottom:"-2px"},u=i.a.createElement(E.a,{className:"small-avatar pos-absolute collapse-chip ignore-node-on-click",style:{left:"-10px",top:"-10px"},onClick:function(){s(!l)}},i.a.createElement(b.a,{className:"pos-absolute noClick",style:r}),i.a.createElement(v.a,{className:"pos-absolute noClick",style:c})),d=l?i.a.createElement("div",null):i.a.createElement("div",{style:{maxWidth:"300px"}},i.a.createElement("table",null,i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,"Group"),i.a.createElement("td",{style:{width:"16px"}}),i.a.createElement("td",{className:"centered-td"},null===t||void 0===t?void 0:t.group)),null===t||void 0===t?void 0:t.columnValues.map((function(e,t){switch(e.title){case"Subitems":case"Person":case"Status":return i.a.createElement("tr",{key:t});default:return i.a.createElement("tr",{key:t},i.a.createElement("td",null,e.title),i.a.createElement("td",{style:{width:"16px"}}),i.a.createElement("td",{className:"centered-td"},""===e.text||null===e.text?"- - -":e.text))}}))))),p=i.a.createElement("div",{className:"react-flow__handle-top react-flow__handle",style:{background:"#0071d9",width:"10px",height:"10px",top:"-5px"}}),m=i.a.createElement("div",{className:"react-flow__handle-left react-flow__handle",style:{background:"var(--color-mud_black)",width:"10px",height:"10px",left:"-5px"}}),f=i.a.createElement("div",{className:"react-flow__handle-right react-flow__handle",style:{background:"var(--color-mud_black)",width:"10px",height:"10px",right:"-5px"}}),y=i.a.createElement("div",{className:"react-flow__handle-bottom react-flow__handle",style:{background:"var(--color-mud_black)",width:"10px",height:"10px",bottom:"-5px"}});return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{position:"fixed",background:null===t||void 0===t?void 0:t.groupColor,height:"16px",borderRadius:"8px",top:"0px",left:"0px",right:"0px"}},i.a.createElement("div",{style:{position:"absolute",background:null===t||void 0===t?void 0:t.groupColor,height:"8px",bottom:"0px",left:"0px",right:"0px"}}),u,i.a.createElement(x.a,{size:"medium",label:null===t||void 0===t?void 0:t.outgoingNodes.length,style:{position:"absolute",right:"-8px",top:"-8px",background:null===t||void 0===t?void 0:t.groupColor}})),i.a.createElement(g.c,{type:"target",position:"top",id:"t",style:{background:"#0071d9",width:"30%",height:"20px",borderRadius:"0%",top:"-5px",opacity:"0%"}}),i.a.createElement(g.c,{type:"source",position:"bottom",id:"b",style:{background:"var(--color-mud_black)",width:"30%",height:"20px",borderRadius:"0%",bottom:"-5px",opacity:"0%"}}),i.a.createElement(g.c,{type:"source",position:"right",id:"r",style:{background:"var(--color-mud_black)",width:"20px",height:"30%",borderRadius:"0%",right:"-5px",opacity:"0%"}}),i.a.createElement(g.c,{type:"source",position:"left",id:"l",style:{background:"var(--color-mud_black)",width:"20px",height:"30%",borderRadius:"0%",left:"-5px",opacity:"0%"}}),p,m,f,y,i.a.createElement("div",{style:{maxWidth:"170px"}},i.a.createElement("h4",null,null===t||void 0===t?void 0:t.title)),d,i.a.createElement("div",{style:{textAlign:"center",background:null===t||void 0===t?void 0:t.statusData.color,borderRadius:"4px",padding:"4px",marginTop:"8px"}},""===(null===t||void 0===t?void 0:t.statusData.status)?"Empty":t.statusData.status))})),C=function(){function e(t){Object(c.a)(this,e),this.monday=t,this.QueryConnections(),this.QueryPositions()}return Object(r.a)(e,[{key:"EventHasClass",value:function(e,t){if(null==e.path)return!1;for(var n=Object.entries(e.path[0].classList),o=0;o<n.length;o++)if(n[o][1]===t)return!0;return!1}},{key:"QueryConnections",value:function(){var e=this;this.monday.storage.instance.getItem("connection_objects").then((function(t){console.log(t),null!==t.data.value?(e.connections=JSON.parse(t.data.value),console.log(e.connections)):(e.connections=[],console.log(e.connections))}))}},{key:"GetConnections",value:function(){return this.connections}},{key:"AddConnection",value:function(e){var t=this;if(null!=e){console.log("saving connections ",e);for(var n=-1,o=0;o<this.connections.length;o++)if(this.connections[o].source==e.source&&this.connections[o].target==e.target&&this.connections[o].sourceHandle==e.sourceHandle){n=o;break}n<0?this.connections.push(e):this.connections[o]=e;var i=JSON.stringify(this.connections);this.monday.storage.instance.setItem("connection_objects",i).then((function(e){console.log(e),console.log(i),t.QueryConnections()}))}}},{key:"RemoveConnection",value:function(e,t,n){for(var o=this,i=-1,a=0;a<this.connections.length;a++)if(this.connections[a].source==e&&this.connections[a].target==t&&this.connections[a].sourceHandle==n){i=a;break}if(i>=0){var l=this.connections.splice(0,a);this.connections=l;var s=JSON.stringify(this.connections);this.monday.storage.instance.setItem("connection_objects",s).then((function(e){console.log(e),console.log(s),o.QueryConnections()}))}}},{key:"QueryPositions",value:function(){var e=this;this.monday.storage.instance.getItem("node_positions").then((function(t){console.log(t),null!==t.data.value?(e.positions=JSON.parse(t.data.value),console.log(e.positions)):(e.positions=[],console.log(e.positions))}))}},{key:"GetPositions",value:function(){return this.positions}},{key:"AddPosition",value:function(e){var t=this;if(null!=e){console.log("saving positions ",e);for(var n=-1,o=0;o<this.positions.length;o++)if(this.positions[o].id==e.id){n=o;break}n<0?this.positions.push({id:e.id,position:e.position}):this.positions[o].position=e.position;var i=JSON.stringify(this.positions);this.monday.storage.instance.setItem("node_positions",i).then((function(e){console.log(e),console.log(i),t.QueryPositions()}))}}},{key:"DeleteItem",value:function(e){console.log(typeof e),console.log(e),this.monday.api("mutation ($itemId: Int) \n        { \n            delete_item (item_id: $itemId) { id } \n        }",{variables:{itemId:parseInt(e)}}).then((function(e){}))}}]),e}(),_=(n(87),n(27)),N=n.n(_),w=(n(100),function(e){return i.a.createElement("div",{style:{zIndex:"100",position:"absolute",top:"0px",bottom:"0px",right:"0px",left:"0px",visibility:"hidden"}},i.a.createElement("span",{className:"ui-overlay-item"},null===e||void 0===e?void 0:e.children))}),S=function(e){var t=e.sourceX,n=e.sourceY,o=e.sourcePosition,a=e.targetX,l=e.targetY,s=e.targetPosition,c=(e.connectionLineType,e.connectionLineStyle,Object(g.f)({sourceX:t,sourceY:n,sourcePosition:o,targetX:a,targetY:l,targetPosition:s}));return i.a.createElement("g",null,i.a.createElement("path",{fill:"none",stroke:"#fff",strokeWidth:5,className:"animated",d:c}),i.a.createElement("circle",{cx:a,cy:l,fill:"#0071d9",r:5,stroke:"#fff",strokeWidth:1.5}))},O=n(129),I=n(131),j=function(e){var t=Object(o.useState)(5),n=Object(h.a)(t,2);n[0],n[1];var a=null;function l(e){return console.log("updating data of",e),e.forEach((function(t){"prettyNode"==t.type&&(t.data.outgoingNodes=Object(g.g)(t,e))})),e}function s(t,n,o,i){var a="e"+t+"_"+o+"-"+n;return{id:a,source:t,target:n,sourceHandle:o,targetHandle:i,className:a,type:null===e||void 0===e?void 0:e.pathSettings,animated:!0,style:{stroke:"#fff",strokeWidth:"5px"},label:"jank",labelStyle:{visibility:"hidden"},labelBgBorderRadius:"100%",labelBgStyle:{height:"24.3594",fill:"var(--color-mud_black)",stroke:"white",strokeWidth:"3",visibility:(null===e||void 0===e?void 0:e.edgeGripSetting)?"visible":"hidden"}}}var c=[],r={prettyNode:k};if(null!=(null===e||void 0===e?void 0:e.boardData)){var u=null===e||void 0===e?void 0:e.boardData,d=null===e||void 0===e?void 0:e.filteredItems;console.log("DATA FROM PASSED PROPS",u);var p=u[0].columns;u.forEach((function(e,t){if(1!=e.name.indexOf("Subitems of")){var n=-1,o="",i={},l={},r=0;e.items.forEach((function(e,t){var n=e.group.title;n in i||(i[n]=r,l[n]=0,r++)})),e.items.forEach((function(e,r){var u=e.group.title,m=e.name,g=function(e,t){if(null==e)return"var(--color-snow_white)";var n="var(--color-jarco_gray)";return Object.entries(e).forEach((function(e,o){t==e[1]&&(n="var(--color-snow_white)")})),n}(d,e.id),h=function(e,t){if(null==a){var n="pog";null===t||void 0===t||t.forEach((function(e,t){"Status"==e.title&&(n=e.settings_str)})),a={};var o=JSON.parse(n);Object.entries(o.labels).forEach((function(e){var t=e[0],n=e[1];a[n]=o.labels_colors[t].color}))}var i="";return null===e||void 0===e||e.forEach((function(e,t){"Status"===e.title&&(i=e.text)})),i in a?{status:i,color:a[i]}:{status:"",color:"var(--color-ui_grey)"}}(e.column_values,p);if(""!=e.column_values[0])e.column_values[0].text;c.push({id:e.id,type:"prettyNode",data:{title:m,group:u,groupColor:e.group.color,statusData:h,columnValues:e.column_values,isConnecting:!1},style:{padding:"16px",borderRadius:"8px",background:g,boxShadow:"0px 6px 20px -2px rgba(0, 0, 0, 0.2)"},position:{x:325*i[u]+1e3*t,y:300*l[u]}}),l[u]+=1,n>0&&o==u&&c.push(s(n,e.id,"b","t")),n=e.id,o=u}))}})),console.log("ELEMENTS BEFORE LOADING SAVED DATA",c),c=l(c=function(t){var n=null===e||void 0===e?void 0:e.nodeHelper.GetConnections();if(void 0==n)return t;console.log("loading saved connections of",t);var o=[];return t.forEach((function(e){"prettyNode"==e.type&&o.push(e)})),n.forEach((function(e){var t=s(e.source,e.target,e.sourceHandle,e.targetHandle);o.push(t)})),o}(c=function(t){var n=null===e||void 0===e?void 0:e.nodeHelper.GetPositions();return void 0==n||(console.log("loading saved node positions of",t),t.forEach((function(e){"prettyNode"==e.type&&n.forEach((function(t){t.id==e.id&&(e.position.x=t.position.x,e.position.y=t.position.y)}))}))),t}(c))),console.log("----BOARD DATA LOADED-----"),console.log(c),console.log("----------")}var m=Object(o.useState)(c),f=Object(h.a)(m,2),v=f[0],y=f[1];Object(o.useEffect)((function(){y(c)}),[e]);var b=i.a.createElement("div",null);"none"!==(null===e||void 0===e?void 0:e.backgroundSettings)&&null!==(null===e||void 0===e?void 0:e.backgroundSettings)&&(b=i.a.createElement(g.a,{variant:null===e||void 0===e?void 0:e.backgroundSettings,gap:32,size:2}));var x={currEdge:null,mouseX:null,mouseY:null},E={currNode:null,mouseX:null,mouseY:null},C=i.a.useState(x),_=Object(h.a)(C,2),N=_[0],w=_[1],j=i.a.useState(E),D=Object(h.a)(j,2),R=D[0],H=D[1],P=function(){console.log("context menu closed"),w(x),H(E)};return i.a.createElement(g.e,{onContextMenu:function(e){e.preventDefault(),"react-flow__edge-path"==e.target.className.baseVal?w({currEdge:e.target,mouseX:e.clientX-2,mouseY:e.clientY-4}):"react-flow__edge-textbg"==e.target.className.baseVal&&w({currEdge:e.target.parentNode.parentNode.firstChild,mouseX:e.clientX-2,mouseY:e.clientY-4})},elements:v,nodeTypes:r,onElementClick:null===e||void 0===e?void 0:e.onElementClick,onConnect:function(t){y((function(e){return null!==e&&(e=Object(g.d)(s(t.source,t.target,t.sourceHandle,t.targetHandle),e)),e=l(e),console.log(e),e})),null===e||void 0===e||e.nodeHelper.AddConnection(t)},onConnectStart:function(e,t){var n=t.nodeId,o=t.handleType;console.log("on connect start",{nodeId:n,handleType:o}),y((function(e){return e.forEach((function(e){"prettyNode"==e.type&&(e.data.isConnecting=!0)})),e}))},onConnectStop:function(e){y((function(e){return e.forEach((function(e){"prettyNode"==e.type&&(e.data.isConnecting=!1)})),e}))},onNodeDragStop:function(t,n){null===e||void 0===e||e.nodeHelper.AddPosition(n)},onNodeContextMenu:function(e,t){e.preventDefault(),H({currNode:t,mouseX:e.clientX-2,mouseY:e.clientY-4})},connectionLineComponent:S},i.a.createElement(g.b,null),b,i.a.createElement(O.a,{keepMounted:!0,open:null!==N.mouseY,onClose:P,anchorReference:"anchorPosition",anchorPosition:null!==N.mouseY&&null!==N.mouseX?{top:N.mouseY,left:N.mouseX}:void 0},i.a.createElement(I.a,{onClick:function(){var t=N.currEdge.parentNode.classList.item(2),n=0;for(n=0;n<v.length;n++)if(v[n].id==t){null===e||void 0===e||e.nodeHelper.RemoveConnection(v[n].source,v[n].target,v[n].sourceHandle),y((function(e){return Object(g.h)([v[n]],e)}));break}w(x)}},"Delete Connection")),i.a.createElement(O.a,{keepMounted:!0,open:null!==R.mouseY,onClose:P,anchorReference:"anchorPosition",anchorPosition:null!==R.mouseY&&null!==R.mouseX?{top:R.mouseY,left:R.mouseX}:void 0},i.a.createElement(I.a,{onClick:function(){null===e||void 0===e||e.monday.execute("confirm",{message:"Delete this item? It will be kept in your Recycle Bin for 30 days.",confirmButton:"Delete",cancelButton:"Cancel",excludeCancelButton:!1}).then((function(t){!0===t.data.confirm&&(y((function(e){return Object(g.h)([R.currNode],e)})),H(E),null===e||void 0===e||e.nodeHelper.DeleteItem(R.currNode.id))}))}},"Delete Node")))},D=m()(),R=new C(D),H=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var o;return Object(c.a)(this,n),(o=t.call(this,e)).state={settings:{},name:""},o}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this;D.listen("settings",(function(t){e.setState({settings:t.data})})),D.listen("context",(function(t){e.setState({context:t.data}),D.api("query ($boardIds: [Int]) \n      { \n        boards (ids:$boardIds) { \n          name \n          items { id name group {title color} column_values { title text } } \n          columns {\n            title\n            settings_str\n          }\n        } \n      }",{variables:{boardIds:e.state.context.boardIds}}).then((function(t){e.setState({boardData:t.data})})),console.log(e.state.context)})),D.listen("itemIds",(function(t){e.setState({filteredItems:t.data})})),D.listen("events",(function(e){switch(e.type){case"new_items":alert("NEW ITEM BRUH")}}))}},{key:"render",value:function(){var e,t,n,o,a;return i.a.createElement("div",{className:"App",style:{display:"block",background:"var(--color-mud_black)",fontFamily:"Roboto, sans-serif"}},i.a.createElement(j,{boardData:null===(e=this.state.boardData)||void 0===e?void 0:e.boards,filteredItems:null===(t=this.state)||void 0===t?void 0:t.filteredItems,onElementClick:function(e,t){if(null!=e){try{console.log(JSON.stringify(e))}catch(n){return void console.log("spaghetti code oh yeah")}R.EventHasClass(e,"ignore-node-on-click")?console.log("Click detected, but ignoring."):typeof t===typeof k?(console.log("node actions happened i guess",e),D.execute("openItemCard",{itemId:t.id,kind:"columns"})):alert("OH")}},pathSettings:null===(n=this.state.settings)||void 0===n?void 0:n.pathdisplay,edgeGripSetting:null===(o=this.state.settings)||void 0===o?void 0:o.edgeGrips,backgroundSettings:null===(a=this.state.settings)||void 0===a?void 0:a.backgroundType,nodeHelper:R,monday:D}),i.a.createElement(w,null,i.a.createElement(N.a,{size:"small",style:{marginRight:"8px"},onClick:function(){console.log("priority being found...")}},"Find Priority"),i.a.createElement(N.a,{size:"small",style:{marginRight:"8px"},onClick:function(){console.log("visualizing group priorities...")}},"Visualize Group Priorities"),i.a.createElement(N.a,{size:"small",kind:"secondary",style:{marginRight:"8px"},onClick:function(){}},"Recenter"),i.a.createElement(N.a,Object(s.a)({size:"small",kind:"secondary",style:{marginRight:"8px"},onClick:function(){D.execute("confirm",{message:"Are you sure you want to reset the nodes? You will lose all of the connections that you have made, and all of the original connections will be returned.",confirmButton:"Confirm",cancelButton:"Cancel",excludeCancelButton:!1}).then((function(e){e.data.confirm}))}},"style",{marginRight:"8px"}),"Reset")))}}]),n}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(i.a.createElement(H,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},65:function(e,t,n){},66:function(e,t,n){},87:function(e,t,n){}},[[101,1,2]]]);
//# sourceMappingURL=main.1eb7a02e.chunk.js.map